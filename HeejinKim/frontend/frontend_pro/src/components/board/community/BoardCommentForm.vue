<template>
    <v-container>
        <v-form @submit.prevent="onSubmit">
            <table>
                 <v-row justify="center">
                    
                    <v-col cols>
                        <v-textarea cols="80" rows="3" outlined color="grey" placeholder="Enter your comment" 
                        style="white-space:pre-line" v-model="comment"/>
                    </v-col>
                    
                    <v-btn  type="submit" class="commentBtn" text><v-icon class="deleteIcon" color="#e3c832"> mdi-arrow-right </v-icon></v-btn>
                    
                </v-row>

                <v-row  v-for="comments in boardComments" 
                        :key="comments.commentNo" justify="center" class="commentArea">
                     <v-col cols="2">
                            {{ comments.commentWriter}}
                        </v-col>
                        <v-col cols="5">
                             {{ comments.comment }}
                        </v-col>
                        <v-col cols="4">
                            <!--{{ comments.regDate}}-->
                            {{ comments.regDate}}
                        </v-col>
                        
                    <template v-if="comments.commentWriter == commentWriter">
                                <v-btn class="comRemoveBtn" @click=comRemove(comments.commentNo) small text>
                                <v-icon>
                                   mdi-trash-can-outline
                                </v-icon>
                            </v-btn>
                    </template>
                </v-row>

            </table>
        </v-form>       
    </v-container>
</template>

<script>
import axios from 'axios'

export default {

    name:'BoardCommentForm',

    data () {
        return {
            comment: '',     
            commnetNo:'',
        }
    },

    created () {
       
        this.commentWriter = this.$store.state.session.userId
    },

    props:{
         boardComments: {
            type: Array,
            required: true
        },
        
         /*
         boardNo: {
            type: String,
            required: true
        },   
      
        boardName:{
            type: String,
            required: true
        }*/
    },
    methods:{
        onSubmit(){
            const { comment,commentWriter } = this
            this.$emit('submit',{comment,commentWriter})
            console.log(comment, commentWriter)
        },
        comRemove (commentNo) {
            
            axios.delete(`http://localhost:7777/boardComments/${commentNo}`)
                    .then(() => {
                        alert("Done! Deleted successfully");
                        this.$router.push('/communityBoard')
                    })
                    .catch(() => {
                        alert('삭제 실패!')
                        console.log(commentNo, this.boardNo)
                    })
        },
    }
  
}
</script>
<style scoped>
@import url("https://fonts.googleapis.com/css2?family=Gowun+Dodum&family=Poiret+One&family=Sunflower:wght@300&family=Ubuntu:wght@300&display=swap");
.label{
    font-family: 'Ubuntu', sans-serif; 
    font-size: 15pt;
    margin-right:5%;
    text-align: center;
    padding-top: 25px; 
}
table{
    background-color: #f8f8f8;
    padding: 5% 10% 5% 10%;
    margin-left:auto;
    margin-right:auto;
    width: 855px;
}
.v-text-field, .v-textarea{
    font-family: 'Sunflower', sans-serif;
}
.comRemoveBtn{
    margin-top: 2%;
}
.commentBtn{
      margin-top: 6%;
}
</style>